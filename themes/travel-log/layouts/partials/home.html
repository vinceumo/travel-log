<div class="container">
    {{ range .Site.Pages.GroupByParam "region" "title"}}
        {{ $regionId := .Key | urlize}}
        <h2 id="{{ $regionId }}">{{ .Key }}</h2>
        <ul class="list-unstyle">
            {{ range .Pages.GroupByParam "country" "title"}}
                {{ $countryId := .Key | urlize}}
                <li id="{{ $regionId }}_{{ $countryId }}">
                    <h3>{{ .Key }}</h3>
                    <ul class="list-unstyle grid has-cols-1 has-cols-sm-2 has-cols-md-3 has-cols-lg-4 has-cols-xl-5 has-grid-gap-3">
                        {{ range .Pages.ByTitle }}
                            <li class="thumbnail">
                                <a href="{{ .URL }}" class="post__title">
                                    {{/*  https://discourse.gohugo.io/t/is-it-possible-to-define-staticdir-param-to-be-nested-location/13146  */}}
                                    {{/*  https://gohugo.io/content-management/image-processing/  */}}
                                    {{/*  https://gohugo.io/content-management/page-resources/  */}}
                                    {{/*  Need to move images out of static  */}}
                                    {{/*  {{ $imageThumbnailUrl := string (path.Join "/images/"  .Params.imgDir .Params.thumbnail) }} 
                                    <img class="img-fluid" src="{{ $imageThumbnailUrl }}" alt="">  */}}

                                    {{ $string :=  "/"}}
                                    {{ $targetPath := string (path.Join "images/" .Params.imgDir .Params.thumbnail) }}
                                    {{ $vars := $string | resources.FromString $targetPath }}
                                    <img class="img-fluid" src="{{ $vars.RelPermalink | safeURL }}" alt="">

                                    <b>{{ .Title }}</b><br>
                                    {{ .Params.Country }}
                                </a>
                            </li>
                        {{ end }}
                    </ul>
                </li> 
            {{ end }}
        </ul>
    {{ end }}
    {{ .Content }}
 </div>